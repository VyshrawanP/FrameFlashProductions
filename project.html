<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Projects — FrameFlash Productions</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="/style.css">

</head>

<body>
    <canvas id="smoke"></canvas>
    <div id="loader" class="loader-overlay">
  <div class="spinner"></div>
</div>

<header>
    <div class="brand">
    <img src="/logos/fflogo.png">

  </div>
  <nav class="desktop-nav">
    <a href="/index.html">Home</a>
    <a href="/project.html">Projects</a>
    <a href="/about.html">About</a>
    <a href="/contact.html">Contact</a>
    <a href="/privacypolicy.html">Privacy</a>
  </nav>
  <button class="menu-btn">☰</button>
</header>

<div class="mobile-menu">
  <a href="index.html">Home</a>
  <a href="projects.html">Projects</a>
  <a href="about.html">About</a>
  <a href="contact.html">Contact</a>
</div>
<div class="menu-overlay"></div>

<main id="projects-container">
  <h1>Projects</h1>

  <!-- local loader -->
  <div id="projects-loader" class="projects-loader">
    <div class="spinner"></div>
  </div>

  <!-- dynamic content goes here -->
  <div id="projects-list"></div>
</main>

  

<footer>
  © 2025 FrameFlash Productions · Where Ideas Become Motion
</footer>


<script>
  
const movies = [
  {
    title: "CIPHER",
    vp: "cipher",
    thumbnail_url: "...",
    about_lite: "..."
  },
  {
    title: "GREY",
    vp: "grey",
    thumbnail_url: "...",
    about_lite: "..."
  }
];

 
async function loadProjects() {
  const loader = document.getElementById("projects-loader");
  const list = document.getElementById("projects-list");
  loader.classList.add("hidden");


  try {
    loader.style.display = "flex";

    const cfg = await fetch("/.netlify/functions/config").then(r => r.json());

    const res = await fetch(
      `${cfg.SUPABASE_URL}/rest/v1/movies?select=title,about_lite,thumbnail_url,vp&order=created_at.asc`,
      {
        headers: { apikey: cfg.SUPABASE_ANON_KEY }
      }
    );

    const movies = await res.json();

    list.innerHTML = "";

    movies.forEach(m => {
      const div = document.createElement("div");
      div.className = "project";

      div.innerHTML = `
        <img src="${m.thumbnail_url}" alt="${m.title}">
        <div class="project-info">
          <h2>${m.title}</h2>
          <p>${m.about_lite}</p>
          <a href="${m.vp}.html">View Project →</a>
        </div>
      `;

      list.appendChild(div);
    });

  } catch (e) {
    list.innerHTML = "<p>Failed to load projects.</p>";
    console.error(e);
  } finally {
    loader.style.display = "none";
  }
}




/* REVEAL */
const projects=document.querySelectorAll(".project");
const observer=new IntersectionObserver(
  entries=>{
    entries.forEach(e=>{
      if(e.isIntersecting){
        e.target.classList.add("visible");
        observer.unobserve(e.target);
      }
    });
  },
  {threshold:.25, rootMargin:"0px 0px -100px 0px"}
);
projects.forEach(p=>observer.observe(p));

(function(){
  if (window.innerWidth < 900) return;
  const c = document.getElementById("smoke");
  if (!c) return;
  const ctx = c.getContext("2d");
  let w,h,mouseX=0,mouseY=0;

  function resize(){
    w=c.width=innerWidth;
    h=c.height=innerHeight;
  }
  resize(); addEventListener("resize",resize);

  addEventListener("mousemove",e=>{
    mouseX=e.clientX;
    mouseY=e.clientY;
  });

  const blobs=[...Array(8)].map(()=>({
    x:Math.random()*w,
    y:Math.random()*h,
    r:250+Math.random()*200,
    vx:(Math.random()-.5)*.1,
    vy:(Math.random()-.5)*.1
  }));

  function draw(){
    ctx.clearRect(0,0,w,h);
    blobs.forEach(b=>{
      b.x+=b.vx+(mouseX-b.x)*.00002;
      b.y+=b.vy+(mouseY-b.y)*.00002;
      if(b.x<-b.r)b.x=w+b.r;
      if(b.x>w+b.r)b.x=-b.r;
      if(b.y<-b.r)b.y=h+b.r;
      if(b.y>h+b.r)b.y=-b.r;

      const g=ctx.createRadialGradient(b.x,b.y,0,b.x,b.y,b.r);
      g.addColorStop(0,"rgba(150,30,30,.2)");
      g.addColorStop(1,"rgba(150,30,30,0)");
      ctx.fillStyle=g;
      ctx.beginPath();
      ctx.arc(b.x,b.y,b.r,0,Math.PI*2);
      ctx.fill();
    });
    requestAnimationFrame(draw);
  }
  draw();
})();
async function loadProjects() {
  // 1. Get env config from Netlify function
  const cfg = await fetch("/.netlify/functions/config").then(r => r.json());

  // 2. Fetch movies from Supabase
  const res = await fetch(
    `${cfg.SUPABASE_URL}/rest/v1/movies?select=title,about_lite,thumbnail_url,vp&order=created_at.asc`,
    {
      headers: {
        apikey: cfg.SUPABASE_ANON_KEY
      }
    }
  );

  const movies = await res.json();

  // 3. Render to page
  const container = document.querySelector("main");
  container.innerHTML = "<h1>Projects</h1>";

  movies.forEach(m => {

    const div = document.createElement("div");
    div.className = "project visible";

    div.innerHTML = `

    <img src="${m.thumbnail_url}" alt="${m.title}">
      <div class="project-info">
        
        <h2>${m.title}</h2>
        <p>${m.about_lite}</p>
        <a href="${m.vp}.html">View Project →</a>

      </div>

    `;

    container.appendChild(div);
  });
}

// run
loadProjects();
      const menuBtn = document.querySelector(".menu-btn");
  const mobileMenu = document.querySelector(".mobile-menu");
  const overlay = document.querySelector(".menu-overlay");

  menuBtn.onclick = () => {
    mobileMenu.classList.add("open");
    overlay.classList.add("show");
  };

  overlay.onclick = () => {
    mobileMenu.classList.remove("open");
    overlay.classList.remove("show");
  };
const members = document.querySelectorAll(".member");
</script>

</body>
</html>
